[{"content":"众所周知，Windows 上 Latex 编译速度被 Linux 吊着打不知道几个来回。故打算以后都用 Linux 写 Latex。\n但是毕竟 Linux 还算不上是主力系统，要写 Latex 重启切换 Linux 十分麻烦，那么我们可以在 wsl 上装 TeXLive。\n又众所周知的是，wsl 默认装在 C 盘，而 TeXLive 近 10GB，所以有了这篇记录。\n安装 WSL2 虚拟机到非系统盘 安装并启用 WSL2 教程已经满天飞了，故不再赘述。直接从安装 Linux 发行版开始。\n到 下载发行版 选择你喜欢的系统下载，这里我选择了 Ubuntu 24.04。\n把下载的文件 Ubuntu2404-240425.AppxBundle 后缀改为 zip 并解压。\n在解压出的文件夹中选择符合你机器的系统包，AMD64 下所需文件为 Ubuntu_2404.0.5.0_x64.appx，改后缀为 zip 并将其解压到你要安装的路径下。比如我把它放在了 D:\\WSL\\Ubuntu2404-240425 下。\n双击路径中的 ubuntu2404.exe 等待并设置用户名和密码就大功告成了。\n更换清华源等更多个性化配置自行搜索教程。\n下载 TeXLive 并安装至 WSL 到国内镜像站下载最新 TeXLive 镜像，比如 清华大学开源软件镜像站。\nWSL 是可以直接访问 Windows 的文件的，比如 C 盘的内容在 /mnt/c/ 下。假设我们下载的 TeXLive 镜像路径是 C:\\texlive2024.iso。\n1 2 3 4 5 6 # 新建要挂载的目录 sudo mkdir /mnt/texlive # 把TeXLive镜像挂载过来 sudo mount /mnt/c/texlive2024.iso /mnt/texlive # 执行安装脚本 sudo /mnt/texlive/install-tl 之后的页面你可以修改一些安装可选项，如果你懒得折腾就直接输入 I 默认安装即可。（个性化选项若有所需请自行了解）\n安装过程可能需要几分钟，等待即可。之后弹出镜像并删除文件夹：\n1 2 sudo umount /mnt/texlive sudo rm -r /mnt/texlive 之后更新环境变量，修改 ~/.bashrc 文件在最后新增：\n1 2 3 4 # Add TeX Live to the PATH, MANPATH, INFOPATH export PATH=/usr/local/texlive/2024/bin/x86_64-linux:$PATH export MANPATH=/usr/share/man:/usr/local/texlive/2024/texmf-dist/doc/man:$MANPATH export INFOPATH=/usr/local/texlive/2024/texmf-dist/doc/info:$INFOPATH 重启终端或执行 source ~/.bashrc 即可。\n之后可以执行 tex -v 查看安装是否成功。\n我看的教程还有一个操作，不知道什么作用，反正执行就对了（\n1 2 sudo cp /usr/local/texlive/2024/texmf-var/fonts/conf/texlive-fontconfig.conf /etc/fonts/conf.d/09-texlive.conf sudo fc-cache -fsv VSCode 写 LaTex 配置 基础配置 安装以下几个插件：\nLaTeX Workshop（必选） English word hint Path Autocomplete 新建一个文件夹用于存放 tex 文件，假设名为 LaTexSpace。\n新建 LaTexSpace/.vscode/setting.json 。\n配置编译工具链，添加如下内容：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 \u0026#34;latex-workshop.latex.tools\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;pdflatex\u0026#34;, \u0026#34;command\u0026#34;: \u0026#34;pdflatex\u0026#34;, \u0026#34;args\u0026#34;: [ \u0026#34;-synctex=1\u0026#34;, \u0026#34;-interaction=nonstopmode\u0026#34;, \u0026#34;-file-line-error\u0026#34;, \u0026#34;%DOCFILE%\u0026#34; ] }, { \u0026#34;name\u0026#34;: \u0026#34;xelatex\u0026#34;, \u0026#34;command\u0026#34;: \u0026#34;xelatex\u0026#34;, \u0026#34;args\u0026#34;: [ \u0026#34;-synctex=1\u0026#34;, \u0026#34;-interaction=nonstopmode\u0026#34;, \u0026#34;-file-line-error\u0026#34;, \u0026#34;%DOCFILE%\u0026#34; ] }, { \u0026#34;name\u0026#34;: \u0026#34;bibtex\u0026#34;, \u0026#34;command\u0026#34;: \u0026#34;bibtex\u0026#34;, \u0026#34;args\u0026#34;: [ \u0026#34;%DOCFILE%\u0026#34; ] }, // 下面这个是使用外部 PDF 查看器用的，仅配置编译工具链无需添加 { \u0026#34;name\u0026#34;: \u0026#34;correct_path\u0026#34;, \u0026#34;command\u0026#34;: \u0026#34;/home/spirit/LaTexSpace/.vscode/correct_path\u0026#34; }, ], // 下面 tools 中的 correct_path 也是要在 VSCode+wsl 环境下使用 Windows 的 PDF 查看器才需要添加的。 \u0026#34;latex-workshop.latex.recipes\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;xelatex\u0026#34;, \u0026#34;tools\u0026#34;: [ \u0026#34;xelatex\u0026#34;, \u0026#34;correct_path\u0026#34; ], }, { \u0026#34;name\u0026#34;: \u0026#34;pdflatex\u0026#34;, \u0026#34;tools\u0026#34;: [ \u0026#34;pdflatex\u0026#34;, \u0026#34;correct_path\u0026#34; ] }, { \u0026#34;name\u0026#34;: \u0026#34;xe-\u0026gt;bib-\u0026gt;xe-\u0026gt;xe\u0026#34;, \u0026#34;tools\u0026#34;: [ \u0026#34;xelatex\u0026#34;, \u0026#34;bibtex\u0026#34;, \u0026#34;xelatex\u0026#34;, \u0026#34;xelatex\u0026#34;, \u0026#34;correct_path\u0026#34; ] }, { \u0026#34;name\u0026#34;: \u0026#34;pdf-\u0026gt;bib-\u0026gt;pdf-\u0026gt;pdf\u0026#34;, \u0026#34;tools\u0026#34;: [ \u0026#34;pdflatex\u0026#34;, \u0026#34;bibtex\u0026#34;, \u0026#34;pdflatex\u0026#34;, \u0026#34;pdflatex\u0026#34;, \u0026#34;correct_path\u0026#34; ] }, ], 配置 SumatraPDF 作外部查看器 首先贴上 SumatraPDF官网。\n在设置文件中添加以下内容：\n1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026#34;latex-workshop.view.pdf.viewer\u0026#34;: \u0026#34;external\u0026#34;, \u0026#34;latex-workshop.view.pdf.external.viewer.command\u0026#34;: \u0026#34;/mnt/d/Program/SumatraPDF/SumatraPDF.exe\u0026#34;, // 改为自己的路径 \u0026#34;latex-workshop.view.pdf.external.viewer.args\u0026#34;: [ \u0026#34;%PDF%\u0026#34; ], \u0026#34;latex-workshop.view.pdf.external.synctex.command\u0026#34;: \u0026#34;/mnt/d/Program/SumatraPDF/SumatraPDF.exe\u0026#34;, // 改为自己的路径 \u0026#34;latex-workshop.view.pdf.external.synctex.args\u0026#34;: [ \u0026#34;-forward-search\u0026#34;, \u0026#34;\\\\\\\\wsl$\\\\Ubuntu-24.04\\\\%TEX%\u0026#34;, // 中间的 Ubuntu-24.04 改为自己的发行版名称 \u0026#34;%LINE%\u0026#34;, \u0026#34;-reuse-instance\u0026#34;, \u0026#34;\\\\\\\\wsl$\\\\Ubuntu-24.04\\\\%PDF%\u0026#34; // 改为自己的发行版名称 ], 不知道自己发行版准确名称的话可以使用 wsl -l -v 命令查看。\n此外还需要把 WSL 的路径转为 Windows 的，如上一小节添加 correct_path 工具，并新建 LaTexSpace/.vscode/correct_path 文件。其内容如下，注意其中的路径和发行版名称都要修改为自己的。\n1 2 3 gunzip *.synctex.gz sed -i \u0026#34;s/\\/home\\/spirit\\/LaTexSpace\\//\\\\\\\\\\\\\\\\wsl$\\\\\\\\Ubuntu-24.04\\\\\\\\home\\\\\\\\spirit\\\\\\\\LaTexSpace\\\\\\\\/g\u0026#34; *.synctex gzip *.synctex 配置 latexindent 格式化 tex 文档 在 setting.json 中添加如下内容：\n1 2 3 \u0026#34;latex-workshop.formatting.latex\u0026#34;: \u0026#34;latexindent\u0026#34;, // 修改为自己的 TeXLive 路径 \u0026#34;latex-workshop.formatting.latexindent.path\u0026#34;: \u0026#34;/usr/local/texlive/2024/bin/x86_64-linux/latexindent\u0026#34; latexindent 是一个 perl 脚本。要使用它需要安装依赖：\n1 2 3 4 5 sudo cpan Log::Log4perl sudo cpan Log::Dispatch sudo cpan YAML::Tiny sudo cpan File::HomeDir sudo cpan Unicode::GCString 踩坑 \u0026lsquo;xxx.sty\u0026rsquo; not found 缺啥装啥就行。\n1 sudo tlmgr install xxx sudo 执行 tlmgr，command not found 因为 sudo 并不使用用户的环境变量，也不调用shell执行命令。故你折腾 ~/.bashrc /etc/profile 什么的都是没用的。\n可以在命令中指定环境变量：\n1 sudo env PATH=\u0026#34;$PATH\u0026#34; tlmgr install package 但是这样做好麻烦，在 ~/.bashrc 中用 alias 简化一下吧：\n1 alias psudo=\u0026#39;sudo env PATH=\u0026#34;$PATH\u0026#34;\u0026#39; 这样用 psudo 代替 sudo 就是使用当前终端的环境变量了。\n还有一种强制 sudo 在 shell 中执行命令的办法，对应内容如下：\n1 2 sudo sh -l -c tlmgr install package alias shsudo=\u0026#39;sudo sh -l -c\u0026#39; 编译一个 Beamer 模板莫名失败 缺包导致的，TeXLive 镜像默认不带这些东西吗？\n1 sudo apt install latex-cjk-all texlive-lang-chinese texlive-lang-english 说起来我之前折腾 TeXLive 似乎是直接 sudo apt install texlive-full 来着，不知道会不会有这个问题。但我忘完了。\n复制 Windows 字体到 WSL 1 2 3 4 5 6 7 8 9 sudo mkdir /usr/share/fonts/windows_fonts cd /usr/share/fonts/windows_fonts sudo cp /mnt/c/Windows/Fonts/*.ttf ./ sudo cp /mnt/c/Windows/Fonts/*.TTF ./ sudo cp /mnt/c/Windows/Fonts/*.otf ./ sudo cp /mnt/c/Windows/Fonts/simsun.ttc ./ sudo mkfontscale sudo mkfontdir fc-cache -fv perl 依赖装不上 需要先安装一些工具：\n1 2 # 事到如今我也不知道哪个有用了，都tm装上得了 sudo apt install gcc g++ gcc-multilib g++-multilib make cmake build-essential libperl-dev build-essential libperl-dev 这样还会有一个依赖 Log::Dispatch 装不上。顺着报错的依赖一路追到上游然后手动编译安装就好了：\n1 2 3 4 5 6 7 wget https://www.cpan.org/modules/by-module/Devel/Module-Pluggable-6.2.tar.gz gzip -dc Module-Pluggable-6.2.tar.gz | tar xf - cd Module-Pluggable-6.2 perl Makefile.PL make make test sudo make install 然后顺着这一串报错的依赖再装回来：\n1 2 3 4 sudo cpan Test2::Plugin::NoWarnings sudo cpan Params::ValidationCompiler # 说不定直接跑这个就行了？试试？ sudo cpan Log::Dispatch 然后这 byd latexindent 就终于能用了。\n说实话我现在感觉手写的 tex 挺好看的，没事别瞎折腾（能跑就行\n参考文献 WSL2 虚拟机 其他盘安装(非C盘)及调试(含填坑)\nTeX Live 2024 安装教程（Windows/WSL/Linux）\nPermission problem when installing package from tlmgr\nSetting TeX Live path for root\nCPAN general build error (or fail during \u0026ldquo;install Module::ScanDeps\u0026rdquo;)\nhilinxinhui/VSCode_LaTeX_configuration\nubuntu下vscode LaTeX文档格式化\nshinyypig/latex-vscode-config\n基于WSL-LaTeX的VS Code+SumatraPDF协作\nWSL下LaTeX的VS Code+SumatraPDF协作\nVS Code的LaTeX配置\nLaTeX配置安装大对比：TeXLive/MiKTeX、Windows/WSL、xelatex/lualatex/pdflatex编译器的速度性能详细对比\n","date":"2024-12-07T20:03:48+08:00","permalink":"https://rxzcloud.top/posts/2024/install-texlive-on-wsl/","title":"WSL2安装TeXLive踩坑记录"}]