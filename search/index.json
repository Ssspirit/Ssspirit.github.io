[{"content":"新服务器配置 我买的是阿里云99计划 99r 一年的服务器。找客服说一下一共能以优惠价买三年。\n镜像我选择了 ubuntu24.04。\n首先到阿里云控制台重置 root 密码。建议设置一个较为复杂的密码，并保存好。\n软件源已经默认设置为了阿里云源，无需手动更换了。\n通过控制台的远程连接连接到服务器，安装一些必要软件：\n1 2 3 sudo apt update sudo apt upgrade sudo apt install vim gcc g++ gcc-multilib g++-multilib make cmake build-essential python-is-python3 wget gnupg dpkg apt-transport-https lsb-release ca-certificates curl 我习惯新建一个用户来做管理，添加新用户：\n1 2 3 4 5 6 # 添加账户 newuser useradd newuser # 为账户 newuser 设置密码 passwd newuser # 将新用户添加到 root 组 adduser newuser sudo 修改ssh设置，仅允许密钥登录：\n1 2 3 4 5 6 sudo vim /etc/ssh/sshd_config # 在配置文件中修改或添加以下两项： #禁用密码验证 PasswordAuthentication no #启用密钥验证 PubkeyAuthentication yes 接下来添加公钥，如果本机没有生成过公钥，可以搜索 windows ssh公钥生成\n1 2 3 4 5 6 mkdir /home/spirit/.ssh -p # 将公钥粘贴进去保存即可 vim /home/spirit/.ssh/authorized_keys # 重启ssh服务 sudo service ssh restart 然后就可以在本地使用 ssh 连接服务器了。\n修改 ~\\.ssh\\config 文件（注意修改自定义内容）：\n1 2 3 4 5 6 7 Host aliyun-ubuntu24 HostName your-ip User your-user-name TCPKeepAlive yes ServerAliveInterval 60 ServerAliveCountMax 30 IdentityFile \u0026#34;C:\\Users\\your-local-username\\.ssh\\id_rsa\u0026#34; 修改一下默认 shell：\n1 2 3 4 5 ssh aliyun-ubuntu24 # 查看所有 shell sudo cat /etc/shells # 修改默认 shell 为 bash chsh # 输入 bash 路径即可 安装 docker 添加 Docker 官方 GPG 密钥：\n1 curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add - 添加 Docker 仓库：\n1 sudo add-apt-repository \u0026#34;deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable\u0026#34; 更新软件包索引\n1 sudo apt update 安装最新版本的Docker CE（社区版）：\n1 sudo apt-get install docker-ce 查看 Docker 是否正常运行：\n1 2 3 sudo systemctl status docker docker --version 将当前用户添加到 docker 组：\n1 sudo usermod -aG docker ${USER} 配置镜像加速：在阿里云容器镜像服务 中可以获取专属 url。根据其中提示配置镜像即可。\n重新登录后运行 hello-world 测试：\n1 docker run hello-world 创建 anki-sync-server 1 2 3 4 5 6 7 # 首次添加需要以下命令，其中用户名、密码及端口自定义即可（就是那个23456） docker run -d \\ -e \u0026#34;SYNC_USER1=sync_name:password\u0026#34; \\ --publish 23456:8080 \\ --volume ./data:/syncserver \\ --name anki-sync-server \\ ghcr.io/yangchuansheng/anki-sync-server:latest docker run 会创建并运行新的容器。创建好容器以后用以下命令管理：\n1 2 3 4 5 6 docker ps [-a] # 加上-a参数是列出所有容器，否则是列出运行中的容器 docker rm CONTAINER # 删除名为 CONTAINER 的容器 # 以下分别为运行/停止/重启容器 docker start CONTAINER docker stop CONTAINER docker restart CONTAINER 之后需要去阿里云-云服务器ECS-安全组-管理规则-入方向中开放端口。\n使用手动添加，填入端口，授权对象为所有 IPv4即可。\n同步服务器的地址即为：http://服务器公网IP:23456\n参考文献 Ubuntu 24.04 LTS 安装Docker\nDocker命令大全\nanki-sync-server\n","date":"2025-02-25T20:49:46+08:00","permalink":"https://rxzcloud.top/posts/cloud-server/anki-sync-server/","title":"Anki同步服务器搭建"},{"content":"众所周知，Windows 上 Latex 编译速度被 Linux 吊着打不知道几个来回。故打算以后都用 Linux 写 Latex。\n但是毕竟 Linux 还算不上是主力系统，要写 Latex 重启切换 Linux 十分麻烦，那么我们可以在 wsl 上装 TeXLive。\n又众所周知的是，wsl 默认装在 C 盘，而 TeXLive 近 10GB，所以有了这篇记录。\n安装 WSL2 虚拟机到非系统盘 安装并启用 WSL2 教程已经满天飞了，故不再赘述。直接从安装 Linux 发行版开始。\n到 下载发行版 选择你喜欢的系统下载，这里我选择了 Ubuntu 24.04。\n把下载的文件 Ubuntu2404-240425.AppxBundle 后缀改为 zip 并解压。\n在解压出的文件夹中选择符合你机器的系统包，AMD64 下所需文件为 Ubuntu_2404.0.5.0_x64.appx，改后缀为 zip 并将其解压到你要安装的路径下。比如我把它放在了 D:\\WSL\\Ubuntu2404-240425 下。\n双击路径中的 ubuntu2404.exe 等待并设置用户名和密码就大功告成了。\n更换清华源等更多个性化配置自行搜索教程。\n下载 TeXLive 并安装至 WSL 到国内镜像站下载最新 TeXLive 镜像，比如 清华大学开源软件镜像站。\nWSL 是可以直接访问 Windows 的文件的，比如 C 盘的内容在 /mnt/c/ 下。假设我们下载的 TeXLive 镜像路径是 C:\\texlive2024.iso。\n1 2 3 4 5 6 # 新建要挂载的目录 sudo mkdir /mnt/texlive # 把TeXLive镜像挂载过来 sudo mount /mnt/c/texlive2024.iso /mnt/texlive # 执行安装脚本 sudo /mnt/texlive/install-tl 之后的页面你可以修改一些安装可选项，如果你懒得折腾就直接输入 I 默认安装即可。（个性化选项若有所需请自行了解）\n安装过程可能需要几分钟，等待即可。之后弹出镜像并删除文件夹：\n1 2 sudo umount /mnt/texlive sudo rm -r /mnt/texlive 之后更新环境变量，修改 ~/.bashrc 文件在最后新增：\n1 2 3 4 # Add TeX Live to the PATH, MANPATH, INFOPATH export PATH=/usr/local/texlive/2024/bin/x86_64-linux:$PATH export MANPATH=/usr/share/man:/usr/local/texlive/2024/texmf-dist/doc/man:$MANPATH export INFOPATH=/usr/local/texlive/2024/texmf-dist/doc/info:$INFOPATH 重启终端或执行 source ~/.bashrc 即可。\n之后可以执行 tex -v 查看安装是否成功。\n我看的教程还有一个操作，不知道什么作用，反正执行就对了（\n1 2 sudo cp /usr/local/texlive/2024/texmf-var/fonts/conf/texlive-fontconfig.conf /etc/fonts/conf.d/09-texlive.conf sudo fc-cache -fsv VSCode 的 LaTex 配置 基础配置 安装以下几个插件：\nLaTeX Workshop（必选） English word hint Path Autocomplete 新建一个文件夹用于存放 tex 文件，假设名为 LaTexSpace。\n新建 LaTexSpace/.vscode/setting.json 。\n配置编译工具链，添加如下内容：\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 \u0026#34;latex-workshop.latex.tools\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;pdflatex\u0026#34;, \u0026#34;command\u0026#34;: \u0026#34;pdflatex\u0026#34;, \u0026#34;args\u0026#34;: [ \u0026#34;-synctex=1\u0026#34;, \u0026#34;-interaction=nonstopmode\u0026#34;, \u0026#34;-file-line-error\u0026#34;, \u0026#34;%DOCFILE%\u0026#34; ] }, { \u0026#34;name\u0026#34;: \u0026#34;xelatex\u0026#34;, \u0026#34;command\u0026#34;: \u0026#34;xelatex\u0026#34;, \u0026#34;args\u0026#34;: [ \u0026#34;-synctex=1\u0026#34;, \u0026#34;-interaction=nonstopmode\u0026#34;, \u0026#34;-file-line-error\u0026#34;, \u0026#34;%DOCFILE%\u0026#34; ] }, { \u0026#34;name\u0026#34;: \u0026#34;bibtex\u0026#34;, \u0026#34;command\u0026#34;: \u0026#34;bibtex\u0026#34;, \u0026#34;args\u0026#34;: [ \u0026#34;%DOCFILE%\u0026#34; ] }, // 下面这个是使用外部 PDF 查看器用的，仅配置编译工具链无需添加 { \u0026#34;name\u0026#34;: \u0026#34;correct_path\u0026#34;, \u0026#34;command\u0026#34;: \u0026#34;/home/spirit/LaTexSpace/.vscode/correct_path\u0026#34; }, ], // 下面 tools 中的 correct_path 也是要在 VSCode+wsl 环境下使用 Windows 的 PDF 查看器才需要添加的。 \u0026#34;latex-workshop.latex.recipes\u0026#34;: [ { \u0026#34;name\u0026#34;: \u0026#34;xelatex\u0026#34;, \u0026#34;tools\u0026#34;: [ \u0026#34;xelatex\u0026#34;, \u0026#34;correct_path\u0026#34; ], }, { \u0026#34;name\u0026#34;: \u0026#34;pdflatex\u0026#34;, \u0026#34;tools\u0026#34;: [ \u0026#34;pdflatex\u0026#34;, \u0026#34;correct_path\u0026#34; ] }, { \u0026#34;name\u0026#34;: \u0026#34;xe-\u0026gt;bib-\u0026gt;xe-\u0026gt;xe\u0026#34;, \u0026#34;tools\u0026#34;: [ \u0026#34;xelatex\u0026#34;, \u0026#34;bibtex\u0026#34;, \u0026#34;xelatex\u0026#34;, \u0026#34;xelatex\u0026#34;, \u0026#34;correct_path\u0026#34; ] }, { \u0026#34;name\u0026#34;: \u0026#34;pdf-\u0026gt;bib-\u0026gt;pdf-\u0026gt;pdf\u0026#34;, \u0026#34;tools\u0026#34;: [ \u0026#34;pdflatex\u0026#34;, \u0026#34;bibtex\u0026#34;, \u0026#34;pdflatex\u0026#34;, \u0026#34;pdflatex\u0026#34;, \u0026#34;correct_path\u0026#34; ] }, ], 配置 SumatraPDF 作外部查看器 首先贴上 SumatraPDF官网。\n在设置文件中添加以下内容：\n1 2 3 4 5 6 7 8 9 10 11 12 13 \u0026#34;latex-workshop.view.pdf.viewer\u0026#34;: \u0026#34;external\u0026#34;, \u0026#34;latex-workshop.view.pdf.external.viewer.command\u0026#34;: \u0026#34;/mnt/d/Program/SumatraPDF/SumatraPDF.exe\u0026#34;, // 改为自己的路径 \u0026#34;latex-workshop.view.pdf.external.viewer.args\u0026#34;: [ \u0026#34;%PDF%\u0026#34; ], \u0026#34;latex-workshop.view.pdf.external.synctex.command\u0026#34;: \u0026#34;/mnt/d/Program/SumatraPDF/SumatraPDF.exe\u0026#34;, // 改为自己的路径 \u0026#34;latex-workshop.view.pdf.external.synctex.args\u0026#34;: [ \u0026#34;-forward-search\u0026#34;, \u0026#34;\\\\\\\\wsl$\\\\Ubuntu-24.04\\\\%TEX%\u0026#34;, // 中间的 Ubuntu-24.04 改为自己的发行版名称 \u0026#34;%LINE%\u0026#34;, \u0026#34;-reuse-instance\u0026#34;, \u0026#34;\\\\\\\\wsl$\\\\Ubuntu-24.04\\\\%PDF%\u0026#34; // 改为自己的发行版名称 ], 不知道自己发行版准确名称的话可以使用 wsl -l -v 命令查看。\n此外还需要把 WSL 的路径转为 Windows 的，如上一小节添加 correct_path 工具，并新建 LaTexSpace/.vscode/correct_path 文件。其内容如下，注意其中的路径和发行版名称都要修改为自己的。\n1 2 3 gunzip *.synctex.gz sed -i \u0026#34;s/\\/home\\/spirit\\/LaTexSpace\\//\\\\\\\\\\\\\\\\wsl$\\\\\\\\Ubuntu-24.04\\\\\\\\home\\\\\\\\spirit\\\\\\\\LaTexSpace\\\\\\\\/g\u0026#34; *.synctex gzip *.synctex 在 Windows 上新建一个 vbs 文件，路径自定义即可。\n注意修改为自己的 wsl 发行版名称和 VSCode 路径。\n1 2 3 4 5 6 Set args = WScript.Arguments arg = \u0026#34;\u0026#34; For Each s In args arg = arg \u0026amp; \u0026#34; \u0026#34; \u0026amp; s Next WScript.CreateObject(\u0026#34;WScript.Shell\u0026#34;).Run \u0026#34;wsl -d Ubuntu-24.04 \u0026#39;/mnt/d/Program Files/Microsoft VS Code/bin/code\u0026#39; \u0026#34; \u0026amp; arg, 0 在 SumatraPDF 的设置-选项中填写反向查找命令，注意微调。\n1 wscript \u0026#34;D:\\Code\\LaTex\\Inverse Search.vbs\u0026#34; -r -g $(echo $(wslpath \u0026#39;%f:%l\u0026#39;) \u0026#34;|\u0026#34; sed \u0026#39;s/\\/mnt\\/d\\/wsl$\\/Ubuntu-24.04//g\u0026#39;) latexindent 格式化 tex 文档 真没必要搞这个，费劲还没用\n在 setting.json 中添加如下内容：\n1 2 3 \u0026#34;latex-workshop.formatting.latex\u0026#34;: \u0026#34;latexindent\u0026#34;, // 修改为自己的 TeXLive 路径 \u0026#34;latex-workshop.formatting.latexindent.path\u0026#34;: \u0026#34;/usr/local/texlive/2024/bin/x86_64-linux/latexindent\u0026#34; latexindent 是一个 perl 脚本。要使用它需要安装依赖：\n1 2 3 4 5 sudo cpan Log::Log4perl sudo cpan Log::Dispatch sudo cpan YAML::Tiny sudo cpan File::HomeDir sudo cpan Unicode::GCString 踩坑 \u0026lsquo;xxx.sty\u0026rsquo; not found 缺啥装啥就行。\n1 sudo tlmgr install xxx sudo 执行 tlmgr，command not found 因为 sudo 并不使用用户的环境变量，也不调用shell执行命令。故你折腾 ~/.bashrc /etc/profile 什么的都是没用的。\n可以在命令中指定环境变量：\n1 sudo env PATH=\u0026#34;$PATH\u0026#34; tlmgr install package 但是这样做好麻烦，在 ~/.bashrc 中用 alias 简化一下吧：\n1 alias psudo=\u0026#39;sudo env PATH=\u0026#34;$PATH\u0026#34;\u0026#39; 这样用 psudo 代替 sudo 就是使用当前终端的环境变量了。\n还有一种强制 sudo 在 shell 中执行命令的办法，对应内容如下：\n1 2 sudo sh -l -c tlmgr install package alias shsudo=\u0026#39;sudo sh -l -c\u0026#39; 编译一个 Beamer 模板莫名失败 缺包导致的，TeXLive 镜像默认不带这些东西吗？\n1 sudo apt install latex-cjk-all texlive-lang-chinese texlive-lang-english 如果最开始用 sudo apt install texlive-full 安装环境似乎没有这个问题，但我没试。感兴趣的可以在新的系统上试试，坏处就是仓库里的是什么版本你就只能用什么版本。\n复制 Windows 字体到 WSL 1 2 3 4 5 6 7 8 9 sudo mkdir /usr/share/fonts/windows_fonts cd /usr/share/fonts/windows_fonts sudo cp /mnt/c/Windows/Fonts/*.ttf ./ sudo cp /mnt/c/Windows/Fonts/*.TTF ./ sudo cp /mnt/c/Windows/Fonts/*.otf ./ sudo cp /mnt/c/Windows/Fonts/simsun.ttc ./ sudo mkfontscale sudo mkfontdir fc-cache -fv 好消息：如果你能使用 deb 包，就不需要上面这个用处不大的东西了。\n可以直接安装Linux字体包（百度网盘，提取码yfsb）。非常全面的同时操作还简单。\nLinuxFont（夸克网盘，提取码ks4L） 。\nperl 依赖装不上 需要先安装一些工具：\n1 2 # 事到如今我也不知道哪个有用了，都tm装上得了 sudo apt install gcc g++ gcc-multilib g++-multilib make cmake build-essential libperl-dev build-essential libperl-dev 这样还会有一个依赖 Log::Dispatch 装不上。顺着报错的依赖一路追到上游然后手动编译安装就好了：\n1 2 3 4 5 6 7 wget https://www.cpan.org/modules/by-module/Devel/Module-Pluggable-6.2.tar.gz gzip -dc Module-Pluggable-6.2.tar.gz | tar xf - cd Module-Pluggable-6.2 perl Makefile.PL make make test sudo make install 然后顺着这一串报错的依赖再装回来：\n1 2 3 4 sudo cpan Test2::Plugin::NoWarnings sudo cpan Params::ValidationCompiler # 说不定直接跑这个就行了？试试？ sudo cpan Log::Dispatch 然后这 byd latexindent 就终于能用了。\n说实话我现在感觉手写的 tex 挺好看的，没事别瞎折腾（能跑就行\n参考文献 WSL2 虚拟机 其他盘安装(非C盘)及调试(含填坑)\nTeX Live 2024 安装教程（Windows/WSL/Linux）\nPermission problem when installing package from tlmgr\nSetting TeX Live path for root\nCPAN general build error (or fail during \u0026ldquo;install Module::ScanDeps\u0026rdquo;)\nhilinxinhui/VSCode_LaTeX_configuration\nubuntu下vscode LaTeX文档格式化\nshinyypig/latex-vscode-config\n基于WSL-LaTeX的VS Code+SumatraPDF协作\nWSL下LaTeX的VS Code+SumatraPDF协作\nVS Code的LaTeX配置\nLaTeX配置安装大对比：TeXLive/MiKTeX、Windows/WSL、xelatex/lualatex/pdflatex编译器的速度性能详细对比\n","date":"2024-12-07T20:03:48+08:00","permalink":"https://rxzcloud.top/posts/2024/install-texlive-on-wsl/","title":"WSL2安装TeXLive踩坑记录"}]